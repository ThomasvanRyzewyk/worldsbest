{{ define "main" }}
<article>
  <header class="product-header">
    <h2>{{ .Title }}</h2>
    {{ with .Params.dek }}<div class="kicker">{{ . }}</div>{{ end }}
  </header>

  {{ with .Params.hero_image }}
    <p><img src="{{ . }}" alt="{{ $.Title }} hero" style="max-width:320px;height:auto"></p>
  {{ end }}

  {{ with .Params.why_its_best }}
    <ul class="list">
      {{ range . }}<li>{{ . }}</li>{{ end }}
    </ul>
  {{ end }}

  {{ if .Params.gallery }}
    <div class="gallery">
      {{ range .Params.gallery }}<img src="{{ . }}" alt="{{ $.Title }} gallery">{{ end }}
    </div>
  {{ end }}

  <div class="review">{{ .Content }}</div>

  {{/* Affiliate button resolved from /data/affiliates.yml by slug */}}
  {{ $slug := .Params.slug | default .File.BaseFileName }}
  {{ with (index site.Data.affiliates $slug) }}
    <p><a class="btn" href="{{ .url }}" target="_blank" rel="sponsored noopener">Buy — {{ .label }}</a></p>
  {{ end }}

  <p><a href="/" class="btn">← Back</a></p>
</article>
{{ end }}
